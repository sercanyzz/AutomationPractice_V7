package StepDefinitions;

import java.util.concurrent.TimeUnit;

import org.openqa.selenium.By;
//import org.openqa.selenium.Keys;
import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.Keys;
import org.openqa.selenium.Point;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.interactions.Actions;

import java.awt.AWTException;
import java.awt.Robot;
import java.util.Random;

import io.cucumber.java.en.And;
import io.cucumber.java.en.Given;
import io.cucumber.java.en.Then;
import io.cucumber.java.en.When;

public class AutomationPracticeSteps 
{
	WebDriver driver=null;

	@Given("Open Chrome Browser")
	public void open_Chrome_Browser() throws InterruptedException 
	{
		String projectPath = System.getProperty("user.dir");
		System.out.println("Project path is: " + projectPath);		
		System.setProperty("webdriver.chrome.driver",projectPath+"/src/test/resources/drivers/chromedriver.exe");	
		driver=new ChromeDriver();		
		driver.manage().timeouts().implicitlyWait(40, TimeUnit.SECONDS);
		driver.manage().timeouts().pageLoadTimeout(40, TimeUnit.SECONDS);		
		Thread.sleep(2000);		
		driver.manage().window().maximize();
	}

	@And("Open Automation Practice page")
	public void open_Automation_Practice_page() throws InterruptedException 
	{
		driver.navigate().to("http://automationpractice.com/");		
		Thread.sleep(2000);
	}

	@When("Sign Up")
	public void sign_Up() throws InterruptedException 
	{
		Random random = new Random();
		int x = random.nextInt(100000);  //rastgele sayý üretir.

		WebElement signIn = driver.findElement(By.className("login"));
		highLight(signIn, driver);

		signIn.click();	
		Thread.sleep(2000);
		driver.findElement(By.id("email_create")).sendKeys("abc"+x+"@hotmail.com");	 //rastgele mail üretilir.
		Thread.sleep(1500);
		WebElement createAccount = driver.findElement(By.id("SubmitCreate"));
		highLight(createAccount, driver);
		Thread.sleep(1000);
		createAccount.click();
		Thread.sleep(1000);
		driver.findElement(By.id("customer_firstname")).sendKeys("test");	
		Thread.sleep(1500);
		driver.findElement(By.id("customer_lastname")).sendKeys("deneme");	
		Thread.sleep(1500);
		driver.findElement(By.id("passwd")).sendKeys("testdeneme1234");	
		Thread.sleep(1500);
		driver.findElement(By.id("address1")).sendKeys("Acýbadem");	
		Thread.sleep(1500);
		driver.findElement(By.id("city")).sendKeys("Ýstanbul");	
		Thread.sleep(1500);
		driver.findElement(By.id("id_state")).click();
		Thread.sleep(1500);
		driver.findElement(By.xpath("//option[contains(text(),'Alabama')]")).click();
		Thread.sleep(1500);
		driver.findElement(By.id("postcode")).sendKeys("12345");	
		Thread.sleep(1500);
		driver.findElement(By.id("phone_mobile")).sendKeys("5334264434");	
		Thread.sleep(1500);

		WebElement regiSter = driver.findElement(By.id("submitAccount"));
		highLight(regiSter, driver);
		Thread.sleep(1000);
		regiSter.click();

		Thread.sleep(1500);
		WebElement logo = driver.findElement(By.id("header_logo"));
		highLight(logo, driver);
		Thread.sleep(1000);
		driver.findElement(By.id("header_logo")).click();  //anasayfaya gidilir.
		Thread.sleep(2000);
		WebElement signOut = driver.findElement(By.xpath("//a[@class='logout']"));  //kullanýcý oluþtuðu kontrol edilir.
		highLight(signOut, driver);				
		Thread.sleep(1500);
	}

	@And("Add products to the cart")
	public void add_products_to_the_cart() throws InterruptedException, AWTException 
	{
		Thread.sleep(2000);
		WebElement dresSes = driver.findElement(By.id("contact-link"));				
		
		highLight(dresSes, driver);				
		Thread.sleep(1000);
		dresSes.click();
		Thread.sleep(1500);
		WebElement summerDresses = driver.findElement(By.xpath("//*[@class='last']"));  
		highLight(summerDresses, driver);				
		Thread.sleep(1000);
		summerDresses.click();

		Thread.sleep(1500);
		JavascriptExecutor js = (JavascriptExecutor) driver;
		js.executeScript("window.scrollBy(0,500)");
		Thread.sleep(1500);
		WebElement produCt = driver.findElement(By.xpath("//img[@class=\"replace-2x img-responsive\"]/@src"));  
		highLight(produCt, driver);	
		Thread.sleep(1000);
		Actions action = new Actions(driver);
		action.moveToElement(produCt).build().perform();			

		Thread.sleep(1500);
		WebElement addToChart = driver.findElement(By.xpath("//li[1]//div[1]//div[2]//div[2]//a[1]//span[1]"));  
		highLight(addToChart, driver);				
		Thread.sleep(1500);
		addToChart.click();
		
		Thread.sleep(2500);
		WebElement close_bTn = driver.findElement(By.xpath("//body/div/div/header/div/div/div/div/div/div/span[1]"));  		
		highLight(close_bTn, driver);				
		Thread.sleep(1000);
		close_bTn.click();
		
		Thread.sleep(1500);
		WebElement searchBar = driver.findElement(By.id("search_query_top"));  
		highLight(searchBar, driver);				
		Thread.sleep(1500);
		searchBar.sendKeys("Summer");
		Thread.sleep(1500);
		searchBar.sendKeys(Keys.ENTER);
		Thread.sleep(1500);
		js.executeScript("window.scrollBy(0,500)");
		
		
		
		Thread.sleep(1500);
		JavascriptExecutor js = (JavascriptExecutor) driver;
		js.executeScript("window.scrollBy(0,500)");
		Thread.sleep(1500);
		WebElement produCt2 = driver.findElement(By.xpath("/html[1]/body[1]/div[2]/div[2]/div[1]/div[3]/div[2]/ul[1]/li[3]/div[1]/div[1]/div[1]/a[1]/img[1]"));  
		highLight(produCt2, driver);	
		Thread.sleep(1000);
		action.moveToElement(produCt2).build().perform();			

		Thread.sleep(1500);
		WebElement addToChart2 = driver.findElement(By.xpath("/html[1]/body[1]/div[2]/div[2]/div[1]/div[3]/div[2]/ul[1]/li[3]/div[1]/div[2]/div[2]/a[1]/span[1]"));  
		highLight(addToChart2, driver);				
		Thread.sleep(1500);
		addToChart2.click();
		
		
		
		
		
		
		//Cart'tan Ürün Kontrolü
		Thread.sleep(2000);
		js.executeScript("window.scrollBy(0,-750)");
		Thread.sleep(1500);
		WebElement caRt = driver.findElement(By.xpath("//b[contains(text(),'Cart')]"));  
		highLight(caRt, driver);	
		Thread.sleep(1000);
		action.moveToElement(caRt).build().perform();	
		
		Thread.sleep(2000);
		WebElement checkOut = driver.findElement(By.xpath("//span[contains(text(),'Check out')]"));  
		highLight(checkOut, driver);				
		Thread.sleep(1500);
		checkOut.click();

		


	}

	@And("Proceed to checkout")
	public void proceed_to_checkout() 
	{

	}

	@Then("Order history and details")
	public void order_history_and_details() 
	{

	}



	//Functions
	public static void highLight(WebElement element, WebDriver driver) throws InterruptedException
	{
		JavascriptExecutor js = (JavascriptExecutor) driver;
		js.executeScript("arguments[0].setAttribute('style', arguments[1]);", element, "color: red; background: yellow; border: 2px dashed red;");  //dashed instead of solid
		Thread.sleep(500);
		//js.executeScript("arguments[0].setAttribute('style', arguments[1]);", element, "");
		//Thread.sleep(500);	      
	}

}
